<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Partial equilibrium trade policy analysis with structural gravity – Solutions Manual for An Advanced Guide to Trade Policy Analysis in R (4th Edition)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-general-equilibrium.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-traditional-gravity.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Partial equilibrium trade policy analysis with structural gravity</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Solutions Manual for An Advanced Guide to Trade Policy Analysis in R (4th Edition)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-traditional-gravity.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Partial equilibrium trade policy analysis with structural gravity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-general-equilibrium.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">General equilibrium trade policy analysis with structural gravity</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#traditional-gravity-estimates" id="toc-traditional-gravity-estimates" class="nav-link active" data-scroll-target="#traditional-gravity-estimates"><span class="header-section-number">2.1</span> Traditional gravity estimates</a>
  <ul class="collapse">
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data"><span class="header-section-number">2.1.1</span> Preparing the data</a></li>
  <li><a href="#ols-estimation-ignoring-multilateral-resistance-terms" id="toc-ols-estimation-ignoring-multilateral-resistance-terms" class="nav-link" data-scroll-target="#ols-estimation-ignoring-multilateral-resistance-terms"><span class="header-section-number">2.1.2</span> OLS estimation ignoring multilateral resistance terms</a></li>
  <li><a href="#ols-estimation-controlling-for-multilateral-resistance-terms-with-remote-indexes" id="toc-ols-estimation-controlling-for-multilateral-resistance-terms-with-remote-indexes" class="nav-link" data-scroll-target="#ols-estimation-controlling-for-multilateral-resistance-terms-with-remote-indexes"><span class="header-section-number">2.1.3</span> OLS estimation controlling for multilateral resistance terms with remote indexes</a></li>
  <li><a href="#ols-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects" id="toc-ols-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects" class="nav-link" data-scroll-target="#ols-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects"><span class="header-section-number">2.1.4</span> OLS estimation controlling for multilateral resistance terms with fixed effects</a></li>
  <li><a href="#ppml-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects" id="toc-ppml-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects" class="nav-link" data-scroll-target="#ppml-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects"><span class="header-section-number">2.1.5</span> PPML estimation controlling for multilateral resistance terms with fixed effects</a></li>
  <li><a href="#presenting-all-models-together" id="toc-presenting-all-models-together" class="nav-link" data-scroll-target="#presenting-all-models-together"><span class="header-section-number">2.1.6</span> Presenting all models together</a></li>
  </ul></li>
  <li><a href="#the-distance-puzzle-resolved" id="toc-the-distance-puzzle-resolved" class="nav-link" data-scroll-target="#the-distance-puzzle-resolved"><span class="header-section-number">2.2</span> The “distance puzzle” resolved</a>
  <ul class="collapse">
  <li><a href="#preparing-the-data-1" id="toc-preparing-the-data-1" class="nav-link" data-scroll-target="#preparing-the-data-1"><span class="header-section-number">2.2.1</span> Preparing the data</a></li>
  <li><a href="#ols-solution-for-the-distance-puzzle" id="toc-ols-solution-for-the-distance-puzzle" class="nav-link" data-scroll-target="#ols-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.2</span> OLS solution for the “distance puzzle”</a></li>
  <li><a href="#ppml-solution-for-the-distance-puzzle" id="toc-ppml-solution-for-the-distance-puzzle" class="nav-link" data-scroll-target="#ppml-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.3</span> PPML solution for the “distance puzzle”</a></li>
  <li><a href="#internal-distance-solution-for-the-distance-puzzle" id="toc-internal-distance-solution-for-the-distance-puzzle" class="nav-link" data-scroll-target="#internal-distance-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.4</span> Internal distance solution for the “distance puzzle”</a></li>
  <li><a href="#internal-distance-and-home-bias-solution-for-the-distance-puzzle" id="toc-internal-distance-and-home-bias-solution-for-the-distance-puzzle" class="nav-link" data-scroll-target="#internal-distance-and-home-bias-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.5</span> Internal distance and home bias solution for the “distance puzzle”</a></li>
  <li><a href="#fixed-effects-solution-for-the-distance-puzzle" id="toc-fixed-effects-solution-for-the-distance-puzzle" class="nav-link" data-scroll-target="#fixed-effects-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.6</span> Fixed effects solution for the “distance puzzle”</a></li>
  <li><a href="#presenting-all-models-together-1" id="toc-presenting-all-models-together-1" class="nav-link" data-scroll-target="#presenting-all-models-together-1"><span class="header-section-number">2.2.7</span> Presenting all models together</a></li>
  </ul></li>
  <li><a href="#regional-trade-agreements-effects" id="toc-regional-trade-agreements-effects" class="nav-link" data-scroll-target="#regional-trade-agreements-effects"><span class="header-section-number">2.3</span> Regional trade agreements effects</a>
  <ul class="collapse">
  <li><a href="#preparing-the-data-2" id="toc-preparing-the-data-2" class="nav-link" data-scroll-target="#preparing-the-data-2"><span class="header-section-number">2.3.1</span> Preparing the data</a></li>
  <li><a href="#ols-standard-rta-estimates-with-international-trade-only" id="toc-ols-standard-rta-estimates-with-international-trade-only" class="nav-link" data-scroll-target="#ols-standard-rta-estimates-with-international-trade-only"><span class="header-section-number">2.3.2</span> OLS standard RTA estimates with international trade only</a></li>
  <li><a href="#ppml-standard-rta-estimates-with-international-trade-only" id="toc-ppml-standard-rta-estimates-with-international-trade-only" class="nav-link" data-scroll-target="#ppml-standard-rta-estimates-with-international-trade-only"><span class="header-section-number">2.3.3</span> PPML standard RTA estimates with international trade only</a></li>
  <li><a href="#addressing-potential-domestic-trade-diversion" id="toc-addressing-potential-domestic-trade-diversion" class="nav-link" data-scroll-target="#addressing-potential-domestic-trade-diversion"><span class="header-section-number">2.3.4</span> Addressing potential domestic trade diversion</a></li>
  <li><a href="#addressing-potential-endogeneity-of-rtas" id="toc-addressing-potential-endogeneity-of-rtas" class="nav-link" data-scroll-target="#addressing-potential-endogeneity-of-rtas"><span class="header-section-number">2.3.5</span> Addressing potential endogeneity of RTAs</a></li>
  <li><a href="#testing-for-potential-reverse-causality-between-trade-and-rtas" id="toc-testing-for-potential-reverse-causality-between-trade-and-rtas" class="nav-link" data-scroll-target="#testing-for-potential-reverse-causality-between-trade-and-rtas"><span class="header-section-number">2.3.6</span> Testing for potential “reverse causality” between trade and RTAs</a></li>
  <li><a href="#addressing-potential-non-linear-and-phasing-in-effects-of-rtas" id="toc-addressing-potential-non-linear-and-phasing-in-effects-of-rtas" class="nav-link" data-scroll-target="#addressing-potential-non-linear-and-phasing-in-effects-of-rtas"><span class="header-section-number">2.3.7</span> Addressing potential non-linear and phasing-in effects of RTAs</a></li>
  <li><a href="#addressing-globalization-effects" id="toc-addressing-globalization-effects" class="nav-link" data-scroll-target="#addressing-globalization-effects"><span class="header-section-number">2.3.8</span> Addressing globalization effects</a></li>
  <li><a href="#presenting-all-models-together-2" id="toc-presenting-all-models-together-2" class="nav-link" data-scroll-target="#presenting-all-models-together-2"><span class="header-section-number">2.3.9</span> Presenting all models together</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">2.4</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Partial equilibrium trade policy analysis with structural gravity</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="traditional-gravity-estimates" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="traditional-gravity-estimates"><span class="header-section-number">2.1</span> Traditional gravity estimates</h2>
<section id="preparing-the-data" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="preparing-the-data"><span class="header-section-number">2.1.1</span> Preparing the data</h3>
<p>If the reader has never used R before, please check chapters 1 to 25 from <span class="citation" data-cites="wickham2016r">Wickham and Grolemund (<a href="#ref-wickham2016r" role="doc-biblioref">2016</a>)</span>.</p>
<p>If the reader has only fitted a few regressions in R, without much practice on transforming and cleaning data before, please check chapters 5 and 18 from <span class="citation" data-cites="wickham2016r">Wickham and Grolemund (<a href="#ref-wickham2016r" role="doc-biblioref">2016</a>)</span>.</p>
<p>Please see the note from page 42 in <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>. It is a really important note, which tells us that we need to:</p>
<ol type="1">
<li>Filter observations for a range of years (1986, 1990, 1994, 1998, 2002 and 2006)</li>
<li>Transform some variables to logarithm scale (trade and dist) and create new variables from those in the original dataset</li>
<li>Remove cases where both the exporter and the importer are the same</li>
<li>Drop observations where the trade flow is zero</li>
</ol>
<p>Unlike <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>, here we shall use a single dataset for all the applications and subset its columns depending on what we need. This decision kept the <em>tradepolicy</em> R package as light as possible.</p>
<p>Before conducting any data filtering or regression, we need to load the required packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tradepolicy)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data transformation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># regression</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(capybara)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># delta method</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(msm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Step 1, including subsetting columns for this application, is straightforward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ch1_application1 <span class="ot">&lt;-</span> agtpa_applications <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(exporter, importer, pair_id, year, trade, dist, cntg, lang, clny) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1986</span>, <span class="dv">2006</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For step 2, this can be divided in parts, starting with the log transformation of trade and distance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ch1_application1 <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_trade =</span> <span class="fu">log</span>(trade),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist =</span> <span class="fu">log</span>(dist)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Continuing step 2, we can now create the variables <span class="math inline">\(Y_{i,t}\)</span> and <span class="math inline">\(E_{i,t}\)</span> that appear on the OLS model equation in the book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ch1_application1 <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Yit</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(exporter, year) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">sum</span>(trade),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_y =</span> <span class="fu">log</span>(y)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Eit</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(importer, year) <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="fu">sum</span>(trade),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_e =</span> <span class="fu">log</span>(e)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The OLS model with remoteness index needs both exporter and importer index, which grouping variables can create. We divide it into sub-steps: Replicate the computation of total exports, then the remoteness index for exporters, and finally the total imports with the corresponding remoteness index for importers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ch1_application1 <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replicate total_e</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(exporter, year) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_e =</span> <span class="fu">sum</span>(e)) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_e =</span> <span class="fu">max</span>(total_e)) <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replicate rem_exp</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(exporter, year) <span class="sc">|&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">remoteness_exp =</span> <span class="fu">sum</span>(dist <span class="sc">*</span> total_e <span class="sc">/</span> e),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_remoteness_exp =</span> <span class="fu">log</span>(remoteness_exp)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replicate total_y</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(importer, year) <span class="sc">|&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_y =</span> <span class="fu">sum</span>(y)) <span class="sc">|&gt;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_y =</span> <span class="fu">max</span>(total_y)) <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replicate rem_imp</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(importer, year) <span class="sc">|&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">remoteness_imp =</span> <span class="fu">sum</span>(dist <span class="sc">/</span> (y <span class="sc">/</span> total_y)),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_remoteness_imp =</span> <span class="fu">log</span>(remoteness_imp)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To create the variables for the OLS with Fixed Effects Model, we followed box #1 on page 44 from <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>. We combine both exporter and importer variables with the year to create the fixed effects variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ch1_application1 <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This merges the columns exporter/importer with year</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_year =</span> <span class="fu">paste0</span>(exporter, year),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">imp_year =</span> <span class="fu">paste0</span>(importer, year)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The addition of exporter/importer time fixed effects concludes step 2, and now we need to perform step 3. This step will be commented for now as I found an error in the reported <span class="math inline">\(R^2\)</span> for the PPML model that I show next.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ch1_application1 &lt;- ch1_application1 |&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(exporter != importer)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some cases require conducting step 4, and we will be explicit about it when needed.</p>
</section>
<section id="ols-estimation-ignoring-multilateral-resistance-terms" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="ols-estimation-ignoring-multilateral-resistance-terms"><span class="header-section-number">2.1.2</span> OLS estimation ignoring multilateral resistance terms</h3>
<p>The general equation for this model is <span class="math display">\[
\begin{align}
\log X_{ij,t} =&amp; \:\beta_0 + \beta_1 DIST_{i,j} + \beta_2 CNTG_{i,j} + \beta_3 LANG_{i,j} + \beta_4 CLNY_{i,j} + \beta_5 \log Y_{i,t} +\\
\text{ }&amp; \:\beta_6 \log E_{j,t} + \varepsilon_{ij,t}.
\end{align}
\]</span></p>
<p>Please see page 41 in <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span> for full detail of each variable.</p>
<p>The model for this case is straightforward, and in this case, we need to apply step 4 from the previous section to drop cases where the trade is zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit_ols <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> log_y <span class="sc">+</span> log_e,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trade <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(exporter <span class="sc">!=</span> importer) <span class="co"># commented out step 3</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>fit_ols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: log_trade ~ log_dist + cntg + lang + clny + log_y + log_e

Estimates:

|             | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|-------------|----------|------------|----------|-----------|
| (Intercept) | -11.2831 |     0.1517 | -74.3632 | 0.0000 ** |
| log_dist    |  -1.0016 |     0.0142 | -70.7423 | 0.0000 ** |
| cntg        |   0.5738 |     0.0744 |   7.7098 | 0.0000 ** |
| lang        |   0.8015 |     0.0337 |  23.7516 | 0.0000 ** |
| clny        |   0.7349 |     0.0704 |  10.4405 | 0.0000 ** |
| log_y       |   1.1902 |     0.0054 | 220.3244 | 0.0000 ** |
| log_e       |   0.9076 |     0.0056 | 162.7301 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

R-squared     : 0.7585 
Adj. R-squared: 0.7585 

Number of observations: Full 25689; Missing 0; Perfect classification 0 </code></pre>
</div>
</div>
<p>Note that the <span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span> look the same because of rounding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit_ols<span class="sc">$</span>r_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7585251</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fit_ols<span class="sc">$</span>adj_r_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7584687</code></pre>
</div>
</div>
<p>The employed function, <code>felm()</code>, does not carry a copy of its training data by default besides providing faster fitting for models with fixed effects. This is not the case in base R, where <code>glm()</code> outputs include this data, increasing the model’s size, but this does not affect the model’s predictions and can be changed as the user needs it <span class="citation" data-cites="trimmingfat">(<a href="#ref-trimmingfat" role="doc-biblioref">Zumel 2014</a>)</span>.</p>
<p>The model is almost ready. We only need to stick to the methodology from <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span> and cluster the standard errors by country pair (see the note on page 42, it is imperative).</p>
<p>The capybara package processes formulas as:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>response <span class="sc">~</span> slopes <span class="sc">|</span> fixed_effects <span class="sc">|</span> cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The model with clustered standard errors is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit_ols <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> log_y <span class="sc">+</span> log_e <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> pair_id,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trade <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(exporter <span class="sc">!=</span> importer) <span class="co"># commented out step 3</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>fit_ols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: log_trade ~ log_dist + cntg + lang + clny + log_y + log_e | 0 | 
    pair_id

Estimates:

|             | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|-------------|----------|------------|----------|-----------|
| (Intercept) | -11.2831 |     0.2958 | -38.1452 | 0.0000 ** |
| log_dist    |  -1.0016 |     0.0273 | -36.6395 | 0.0000 ** |
| cntg        |   0.5738 |     0.1847 |   3.1069 | 0.0019 ** |
| lang        |   0.8015 |     0.0821 |   9.7640 | 0.0000 ** |
| clny        |   0.7349 |     0.1442 |   5.0969 | 0.0000 ** |
| log_y       |   1.1902 |     0.0095 | 125.8863 | 0.0000 ** |
| log_e       |   0.9076 |     0.0099 |  91.5953 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

R-squared     : 0.7585 
Adj. R-squared: 0.7585 

Number of observations: Full 25689; Missing 0; Perfect classification 0 </code></pre>
</div>
</div>
<p>To conduct the RESET test we need to add the squared fitted values to the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ch1_application1_ols <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    trade <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    exporter <span class="sc">!=</span> importer</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ch1_application1_ols <span class="ot">&lt;-</span> ch1_application1_ols <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_hat_sq =</span> (<span class="fu">predict</span>(fit_ols, <span class="at">newdata =</span> ch1_application1_ols))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>reset_ols <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> log_y <span class="sc">+</span> log_e <span class="sc">+</span> trade_hat_sq <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> pair_id,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1_ols</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(reset_ols<span class="sc">$</span>coef_table[<span class="st">"trade_hat_sq"</span>, <span class="st">"Pr(&gt;|z|)"</span>], <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="ols-estimation-controlling-for-multilateral-resistance-terms-with-remote-indexes" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="ols-estimation-controlling-for-multilateral-resistance-terms-with-remote-indexes"><span class="header-section-number">2.1.3</span> OLS estimation controlling for multilateral resistance terms with remote indexes</h3>
<p>The remoteness model adds variables to the OLS model. The general equation for this model is <span class="math display">\[
\begin{align}
\log X_{ij,t} =&amp; \:\beta_0 + \beta_1 DIST_{i,j} + \beta_2 CNTG_{i,j} + \beta_3 LANG_{i,j} + \beta_4 CLNY_{i,j} + \beta_5 \log Y_{i,t} +\\
\text{ }&amp; \beta_6 \log E_{j,t} + \beta_7 \log(REM\_EXP_i,t) + \beta_8 \log(REM\_IMP_i,t) + \varepsilon_{ij,t}.
\end{align}
\]</span></p>
<p>In the equation above <span class="math inline">\(REM\_EXP\)</span> and <span class="math inline">\(REM\_IMP\)</span> are defined as <span class="math display">\[
\begin{align}
\log(REM\_EXP_{i,t}) &amp;= \log \left( \sum_j \frac{DIST_{i,j}}{E_{j,t} / Y_t} \right) \text{ and }\\
\log(REM\_IMP_{j,t}) &amp;= \log \left( \sum_i \frac{DIST_{i,j}}{Y_{i,t} / Y_t} \right).
\end{align}
\]</span></p>
<p>Please see page 43 in <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span> for full detail of each variable.</p>
<p>Our approach follows box #1 on page 43 from <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>. Fitting the regression is straightforward. It is just about adding more regressors to what we did in the last section, and we can create a list with a summary for the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fit_ols_remoteness <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> log_y <span class="sc">+</span> log_e <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    log_remoteness_exp <span class="sc">+</span> log_remoteness_imp <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> pair_id,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trade <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(exporter <span class="sc">!=</span> importer) <span class="co"># commented out step 3</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>fit_ols_remoteness</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: log_trade ~ log_dist + cntg + lang + clny + log_y + log_e + log_remoteness_exp + 
    log_remoteness_imp | 0 | pair_id

Estimates:

|                    | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|--------------------|----------|------------|----------|-----------|
| (Intercept)        | -35.2185 |     1.9859 | -17.7341 | 0.0000 ** |
| log_dist           |  -1.1848 |     0.0313 | -37.8977 | 0.0000 ** |
| cntg               |   0.2466 |     0.1769 |   1.3939 | 0.1633    |
| lang               |   0.7394 |     0.0784 |   9.4304 | 0.0000 ** |
| clny               |   0.8425 |     0.1502 |   5.6081 | 0.0000 ** |
| log_y              |   1.1643 |     0.0095 | 122.8377 | 0.0000 ** |
| log_e              |   0.9026 |     0.0099 |  91.1162 | 0.0000 ** |
| log_remoteness_exp |   0.9718 |     0.0682 |  14.2528 | 0.0000 ** |
| log_remoteness_imp |   0.2737 |     0.0598 |   4.5789 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

R-squared     : 0.765 
Adj. R-squared: 0.765 

Number of observations: Full 25689; Missing 0; Perfect classification 0 </code></pre>
</div>
</div>
<p>For the RESET test, we need to add the squared fitted values to the training data as before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ch1_application1_ols_remoteness <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    trade <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    exporter <span class="sc">!=</span> importer</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>ch1_application1_ols_remoteness <span class="ot">&lt;-</span> ch1_application1_ols_remoteness <span class="sc">|&gt;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_hat_sq =</span> (<span class="fu">predict</span>(fit_ols_remoteness, <span class="at">newdata =</span> ch1_application1_ols_remoteness))<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>reset_ols_remoteness <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> log_y <span class="sc">+</span> log_e <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    log_remoteness_exp <span class="sc">+</span> log_remoteness_imp <span class="sc">+</span> trade_hat_sq <span class="sc">|</span> <span class="dv">0</span> <span class="sc">|</span> pair_id,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1_ols_remoteness</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(reset_ols_remoteness<span class="sc">$</span>coef_table[<span class="st">"trade_hat_sq"</span>, <span class="st">"Pr(&gt;|z|)"</span>], <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2e-04</code></pre>
</div>
</div>
</section>
<section id="ols-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="ols-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects"><span class="header-section-number">2.1.4</span> OLS estimation controlling for multilateral resistance terms with fixed effects</h3>
<p>The general equation for this model is <span class="math display">\[
\begin{align}
\log X_{ij,t} =&amp; \: \beta_1 \log(DIST)_{i,j} + \beta_2 CNTG_{i,j} + \beta_3 LANG_{i,j} +\\
\text{ }&amp; \:\beta_4 CLNY_{i,j} + \pi_{i,t} + \chi_{i,t} + \varepsilon_{ij,t}.
\end{align}
\]</span></p>
<p>Where the added terms, concerning the OLS model, are <span class="math inline">\(\pi_{i,t}\)</span> and <span class="math inline">\(\chi_{i,t}\)</span> that account for exporter-time and importer-time fixed effects, respectively. See page 44 in <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span> for full detail of each variable.</p>
<p>We can quickly generate a list as we did with the previous models. The only difference to the previous models is that in this case that the variables to the right of the “|” operator are the fixed effects, which are treated differently by the <em>fixest</em> package, which is used internally by the <em>tradepolicy</em> package, for faster model fitting.</p>
<p>Please notice that the summaries intentionally do not show fixed effects, because there are cases where we have thousands of fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tp_summary_app_1(</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   formula = log_trade ~ log_dist + cntg + lang + clny | exp_year + imp_year,</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   data = filter(ch1_application1, trade &gt; 0),</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   method = "ols"</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>fit_fe <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trade <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(exporter <span class="sc">!=</span> importer) <span class="co"># commented out step 3</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>fit_fe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: log_trade ~ log_dist + cntg + lang + clny | exp_year + imp_year | 
    pair_id

Estimates:

|          | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|----------|----------|------------|----------|-----------|
| log_dist |  -1.2156 |     0.0376 | -32.3685 | 0.0000 ** |
| cntg     |   0.2232 |     0.1995 |   1.1187 | 0.2633    |
| lang     |   0.6609 |     0.0807 |   8.1860 | 0.0000 ** |
| clny     |   0.6705 |     0.1470 |   4.5614 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

R-squared     : 0.8432 
Adj. R-squared: 0.838 

Number of observations: Full 25689; Missing 0; Perfect classification 0 </code></pre>
</div>
</div>
<p>Note that the <code>felm()</code> function does not print the fixed effects. You can access them with <code>fit_fe$fixed_effects</code> and <code>fit_fe$fe_levels</code> as needed.</p>
<p>For the RESET test, we need to add the squared fitted values to the training data as before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ch1_application1_fe <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    trade <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    exporter <span class="sc">!=</span> importer</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>ch1_application1_fe <span class="ot">&lt;-</span> ch1_application1_fe <span class="sc">|&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_hat_sq =</span> (<span class="fu">predict</span>(fit_fe, <span class="at">newdata =</span> ch1_application1_fe))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>reset_fe <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> trade_hat_sq <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1_fe</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(reset_fe<span class="sc">$</span>coef_table[<span class="st">"trade_hat_sq"</span>, <span class="st">"Pr(&gt;|z|)"</span>], <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="ppml-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="ppml-estimation-controlling-for-multilateral-resistance-terms-with-fixed-effects"><span class="header-section-number">2.1.5</span> PPML estimation controlling for multilateral resistance terms with fixed effects</h3>
<p>The general equation for this model is <span class="math display">\[
\begin{align}
X_{ij,t} =&amp; \:\exp\left[\beta_1 \log(DIST)_{i,j} + \beta_2 CNTG_{i,j} +\right.\\
\text{ }&amp; \:\left.\beta_3 LANG_{i,j} + \beta_4 CLNY_{i,j} + \pi_{i,t} + \chi_{i,t}\right] \times \varepsilon_{ij,t}.
\end{align}
\]</span></p>
<p>The reason to compute this model, despite the lower speed compared to OLS, is that PPML is the only estimator perfectly consistent with the theoretical gravity model. By estimating with PPML, the fixed effects correspond precisely to the corresponding theoretical terms.</p>
<p>The data for this model is the same as for the fixed effects model, and one option in R is to use the <code>fepois()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit_ppml <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(exporter <span class="sc">!=</span> importer) <span class="co"># commented out step 3</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>fit_ppml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist + cntg + lang + clny | exp_year + imp_year | 
    pair_id

Family: Poisson

Estimates:

|          | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|----------|----------|------------|----------|-----------|
| log_dist |  -0.8409 |     0.0317 | -26.5633 | 0.0000 ** |
| cntg     |   0.4374 |     0.0832 |   5.2603 | 0.0000 ** |
| lang     |   0.2475 |     0.0765 |   3.2333 | 0.0012 ** |
| clny     |  -0.2225 |     0.1162 |  -1.9140 | 0.0556 +  |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9461 

Number of observations: Full 28152; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 12 </code></pre>
</div>
</div>
<p>Up to this part, everything matches table 1 in <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>, except for the <span class="math inline">\(R^2\)</span> of the PPML model, which I could not replicate except by obtaining an out-of-sample <span class="math inline">\(R^2\)</span> by obtaining the fitted values including domestic flows. I believe there is a mistake in the book regarding this value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>trade <span class="ot">&lt;-</span> <span class="fu">pull</span>(ch1_application1, trade)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>trade_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_ppml, <span class="at">newdata =</span> ch1_application1)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(trade, trade_hat)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6143843</code></pre>
</div>
</div>
<p>For the RESET test, we need to add the squared fitted link values to the training data as before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ch1_application1_ppml <span class="ot">&lt;-</span> ch1_application1 <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exporter <span class="sc">!=</span> importer)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ch1_application1_ppml <span class="ot">&lt;-</span> ch1_application1_ppml <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_hat_sq =</span> (<span class="fu">predict</span>(fit_ppml, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">newdata =</span> ch1_application1_ppml))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>reset_ppml <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> trade_hat_sq <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application1_ppml</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(reset_ppml<span class="sc">$</span>coef_table[<span class="st">"trade_hat_sq"</span>, <span class="st">"Pr(&gt;|z|)"</span>], <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6416</code></pre>
</div>
</div>
</section>
<section id="presenting-all-models-together" class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="presenting-all-models-together"><span class="header-section-number">2.1.6</span> Presenting all models together</h3>
<p>Capybara provides the <code>summary_table()</code> function to present multiple models together. We can use it to show all the models fitted in this section (note it is a general use function that does not include the RESET test p-values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary_table</span>(fit_ols, fit_ols_remoteness, fit_fe, fit_ppml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>|       Variable       |         (1)         |         (2)         |        (3)         |        (4)         |
|----------------------|---------------------|---------------------|--------------------|--------------------|
| (Intercept)          |           -11.283** |           -35.219** |                    |                    |
|                      |             (0.296) |             (1.986) |                    |                    |
| log_dist             |            -1.002** |            -1.185** |           -1.216** |           -0.841** |
|                      |             (0.027) |             (0.031) |            (0.038) |            (0.032) |
| cntg                 |             0.574** |               0.247 |              0.223 |            0.437** |
|                      |             (0.185) |             (0.177) |            (0.199) |            (0.083) |
| lang                 |             0.802** |             0.739** |            0.661** |            0.247** |
|                      |             (0.082) |             (0.078) |            (0.081) |            (0.077) |
| clny                 |             0.735** |             0.842** |            0.670** |            -0.222+ |
|                      |             (0.144) |             (0.150) |            (0.147) |            (0.116) |
| log_y                |             1.190** |             1.164** |                    |                    |
|                      |             (0.009) |             (0.009) |                    |                    |
| log_e                |             0.908** |             0.903** |                    |                    |
|                      |             (0.010) |             (0.010) |                    |                    |
| log_remoteness_exp   |                     |             0.972** |                    |                    |
|                      |                     |             (0.068) |                    |                    |
| log_remoteness_imp   |                     |             0.274** |                    |                    |
|                      |                     |             (0.060) |                    |                    |
|                      |                     |                     |                    |                    |
| Fixed effects        |                     |                     |                    |                    |
| exp_year             |                  No |                  No |                Yes |                Yes |
| imp_year             |                  No |                  No |                Yes |                Yes |
|                      |                     |                     |                    |                    |
| N                    |              25,689 |              25,689 |             25,689 |             28,152 |
| Pseudo R-squared     |               0.759 |               0.765 |              0.843 |              0.946 |

Standard errors in parenthesis
Significance levels: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10</code></pre>
</div>
</div>
<p>The difference with <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span> is that the 3rd and 4th columns do not include the “grand mean” (intercept) because I included exporter-time and importer-time fixed effects, which remove the need for an intercept as it is absorbed by the fixed effects and the slopes and their standard effect match.</p>
</section>
</section>
<section id="the-distance-puzzle-resolved" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-distance-puzzle-resolved"><span class="header-section-number">2.2</span> The “distance puzzle” resolved</h2>
<section id="preparing-the-data-1" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="preparing-the-data-1"><span class="header-section-number">2.2.1</span> Preparing the data</h3>
<p>Please see the note from page 47 in <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>. We need to proceed with similar steps as in the previous section.</p>
<p>The distance puzzle proposes the gravity specification <span class="math display">\[
\begin{align}
X_{ij,t} =&amp; \:\exp\left[\pi_{i,t} + \chi_{i,t} + \beta_1 \log(DIST)_{i,j} + \beta_2 CNTG_{i,j} + \beta_3 LANG_{i,j}\right]\times\\
\text{ }&amp; \:\exp\left[\beta_4 CLNY_{i,j} + \beta_5 \log(DIST\_INTRA_{i,i})\right] \times \varepsilon_{ij,t}.
\end{align}
\]</span></p>
<p>The difference concerning the last section is that now we need to separate the distance variable into multiple columns that account for discrete-time effects. The <span class="math inline">\(\beta_T\)</span> terms of the equation reflect this. Perhaps the easiest option is to transform the year into a text column and then use the <code>pivot_wider()</code> function.</p>
<p>We need to remove cases where the exporter is the same as the importer and cases where trade is zero for the OLS model. For the PPML models, we need to mark rows where the exporter and the importer are the same, and we need to create the same country column, which is also required to transform the distance variables as shown in box #1 in page 48 from <span class="citation" data-cites="yotov2016advanced">Yotov et al. (<a href="#ref-yotov2016advanced" role="doc-biblioref">2016</a>)</span>.</p>
<p>In order to avoid creating two very similar datasets, we shall create one dataset to cover both OLS and PPML.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ch1_application2 <span class="ot">&lt;-</span> agtpa_applications <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(exporter, importer, pair_id, year, trade, dist, cntg, lang, clny) <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this filter covers both OLS and PPML</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1986</span>, <span class="dv">2006</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># variables for both OLS and PPML</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_year =</span> <span class="fu">paste0</span>(exporter, year),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">imp_year =</span> <span class="fu">paste0</span>(importer, year),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">paste0</span>(<span class="st">"log_dist_"</span>, year),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_trade =</span> <span class="fu">log</span>(trade),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist =</span> <span class="fu">log</span>(dist),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">smctry =</span> <span class="fu">ifelse</span>(importer <span class="sc">!=</span> exporter, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PPML specific variables</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist_intra =</span> log_dist <span class="sc">*</span> smctry,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">intra_pair =</span> <span class="fu">ifelse</span>(exporter <span class="sc">==</span> importer, exporter, <span class="st">"inter"</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> log_dist, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(log_dist_1986<span class="sc">:</span>log_dist_2006, <span class="cf">function</span>(x) x <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> smctry)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>across()</code> function is a shortcut to avoid repetition, as in the following example provided for reference without computation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ch1_application2 <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist_1986 =</span>  log_dist_1986 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> smctry),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist_1990 =</span>  log_dist_1990 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> smctry),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># repeat log_dist_T many_times for T = 1994, 1998, ...</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist_2006 =</span>  log_dist_2006 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> smctry)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the OLS model shall require filtering when we specify the model because we skipped filtering the cases where trade is equal to zero and both the importer and the exporter are the same. Because the solution for the “distance puzzle” implies different transformations and filters for the OLS and PPML cases, one possibility is to filter in the same summary functions.</p>
</section>
<section id="ols-solution-for-the-distance-puzzle" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="ols-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.2</span> OLS solution for the “distance puzzle”</h3>
<p>The gravity specification, which includes <span class="math inline">\(\pi_{i,t} + \chi_{i,t}\)</span>, means that we need to do something very similar to what we did in the last section.</p>
<p>With the data from above, the model specification is straightforward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fit_ols_distance_puzzle <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist_1986 <span class="sc">+</span> log_dist_1990 <span class="sc">+</span> log_dist_1994 <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    log_dist_1998 <span class="sc">+</span> log_dist_2002 <span class="sc">+</span> log_dist_2006 <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">|</span> exp_year <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application2, importer <span class="sc">!=</span> exporter, trade <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>fit_ols_distance_puzzle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: log_trade ~ log_dist_1986 + log_dist_1990 + log_dist_1994 + log_dist_1998 + 
    log_dist_2002 + log_dist_2006 + cntg + lang + clny | exp_year + 
    imp_year | pair_id

Estimates:

|               | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|---------------|----------|------------|----------|-----------|
| log_dist_1986 |  -1.1685 |     0.0429 | -27.2219 | 0.0000 ** |
| log_dist_1990 |  -1.1551 |     0.0416 | -27.7495 | 0.0000 ** |
| log_dist_1994 |  -1.2106 |     0.0449 | -26.9459 | 0.0000 ** |
| log_dist_1998 |  -1.2481 |     0.0421 | -29.6654 | 0.0000 ** |
| log_dist_2002 |  -1.2413 |     0.0434 | -28.6114 | 0.0000 ** |
| log_dist_2006 |  -1.2613 |     0.0430 | -29.3333 | 0.0000 ** |
| cntg          |   0.2230 |     0.1993 |   1.1187 | 0.2633    |
| lang          |   0.6611 |     0.0807 |   8.1899 | 0.0000 ** |
| clny          |   0.6702 |     0.1469 |   4.5616 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

R-squared     : 0.8433 
Adj. R-squared: 0.838 

Number of observations: Full 25689; Missing 0; Perfect classification 0 </code></pre>
</div>
</div>
<p>For the inference, we need to use the Delta method on the estimated coefficients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"log_dist"</span>, <span class="fu">rownames</span>(fit_ols_distance_puzzle<span class="sc">$</span>coef_table), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(beta_log_dist), <span class="fu">max</span>(beta_log_dist))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change = 100 * (beta2 - beta1) / beta1</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> fit_ols_distance_puzzle<span class="sc">$</span>coef_table[, <span class="dv">1</span>][beta_log_dist]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>beta_pct_chg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> (betas[<span class="dv">2</span>] <span class="sc">-</span> betas[<span class="dv">1</span>]) <span class="sc">/</span> betas[<span class="dv">1</span>])</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>beta_vcov_cluster <span class="ot">&lt;-</span> fit_ols_distance_puzzle<span class="sc">$</span>vcov[</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ols_distance_puzzle<span class="sc">$</span>vcov))),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ols_distance_puzzle<span class="sc">$</span>vcov)))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1) <span class="sc">/</span> x1,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(betas[<span class="dv">1</span>], betas[<span class="dv">2</span>]), beta_vcov_cluster</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_pct_chg <span class="sc">/</span> beta_std_err</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pct_chg_log_dist"</span> <span class="ot">=</span> beta_pct_chg,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pct_chg_log_dist          std_err          p-value 
          7.9502           3.6976           0.0316 </code></pre>
</div>
</div>
</section>
<section id="ppml-solution-for-the-distance-puzzle" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="ppml-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.3</span> PPML solution for the “distance puzzle”</h3>
<p>This model is very similar to the one specified in the PPML section from the last section. We can directly fit the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fit_ppml_distance_puzzle <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist_1986 <span class="sc">+</span> log_dist_1990 <span class="sc">+</span> log_dist_1994 <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    log_dist_1998 <span class="sc">+</span> log_dist_2002 <span class="sc">+</span> log_dist_2006 <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">|</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application2, importer <span class="sc">!=</span> exporter)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>fit_ppml_distance_puzzle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist_1986 + log_dist_1990 + log_dist_1994 + log_dist_1998 + 
    log_dist_2002 + log_dist_2006 + cntg + lang + clny | exp_year + 
    imp_year | pair_id

Family: Poisson

Estimates:

|               | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|---------------|----------|------------|----------|-----------|
| log_dist_1986 |  -0.8593 |     0.0370 | -23.1952 | 0.0000 ** |
| log_dist_1990 |  -0.8341 |     0.0377 | -22.1362 | 0.0000 ** |
| log_dist_1994 |  -0.8348 |     0.0351 | -23.7915 | 0.0000 ** |
| log_dist_1998 |  -0.8469 |     0.0354 | -23.9491 | 0.0000 ** |
| log_dist_2002 |  -0.8484 |     0.0316 | -26.8072 | 0.0000 ** |
| log_dist_2006 |  -0.8356 |     0.0312 | -26.7420 | 0.0000 ** |
| cntg          |   0.4372 |     0.0832 |   5.2574 | 0.0000 ** |
| lang          |   0.2475 |     0.0765 |   3.2335 | 0.0012 ** |
| clny          |  -0.2223 |     0.1163 |  -1.9111 | 0.0560 +  |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9462 

Number of observations: Full 28152; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 12 </code></pre>
</div>
</div>
<p>For the inference, we need to use the Delta method on the estimated coefficients as we did in the OLS case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"log_dist"</span>, <span class="fu">rownames</span>(fit_ppml_distance_puzzle<span class="sc">$</span>coef_table), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(beta_log_dist), <span class="fu">max</span>(beta_log_dist))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change = 100 * (beta2 - beta1) / beta1</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> fit_ppml_distance_puzzle<span class="sc">$</span>coef_table[, <span class="dv">1</span>][beta_log_dist]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>beta_pct_chg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> (betas[<span class="dv">2</span>] <span class="sc">-</span> betas[<span class="dv">1</span>]) <span class="sc">/</span> betas[<span class="dv">1</span>])</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>beta_vcov_cluster <span class="ot">&lt;-</span> fit_ppml_distance_puzzle<span class="sc">$</span>vcov[</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ppml_distance_puzzle<span class="sc">$</span>vcov))),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ppml_distance_puzzle<span class="sc">$</span>vcov)))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1) <span class="sc">/</span> x1,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(betas[<span class="dv">1</span>], betas[<span class="dv">2</span>]), beta_vcov_cluster</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_pct_chg <span class="sc">/</span> beta_std_err</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pct_chg_log_dist"</span> <span class="ot">=</span> beta_pct_chg,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pct_chg_log_dist          std_err          p-value 
         -2.7503           3.0039           0.3599 </code></pre>
</div>
</div>
</section>
<section id="internal-distance-solution-for-the-distance-puzzle" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="internal-distance-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.4</span> Internal distance solution for the “distance puzzle”</h3>
<p>This model requires us to add the internal distance variable to the PPML model and not filter the rows where the exporter and the importer are the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_ppml_intra_distance_puzzle <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist_1986 <span class="sc">+</span> log_dist_1990 <span class="sc">+</span> log_dist_1994 <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    log_dist_1998 <span class="sc">+</span> log_dist_2002 <span class="sc">+</span> log_dist_2006 <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    log_dist_intra <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application2</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>fit_ppml_intra_distance_puzzle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist_1986 + log_dist_1990 + log_dist_1994 + log_dist_1998 + 
    log_dist_2002 + log_dist_2006 + cntg + lang + clny + log_dist_intra | 
    exp_year + imp_year | pair_id

Family: Poisson

Estimates:

|                | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|----------------|----------|------------|----------|-----------|
| log_dist_1986  |  -0.9797 |     0.0720 | -13.6042 | 0.0000 ** |
| log_dist_1990  |  -0.9399 |     0.0731 | -12.8558 | 0.0000 ** |
| log_dist_1994  |  -0.9150 |     0.0720 | -12.7027 | 0.0000 ** |
| log_dist_1998  |  -0.8868 |     0.0710 | -12.4819 | 0.0000 ** |
| log_dist_2002  |  -0.8839 |     0.0706 | -12.5150 | 0.0000 ** |
| log_dist_2006  |  -0.8722 |     0.0713 | -12.2331 | 0.0000 ** |
| cntg           |   0.3714 |     0.1396 |   2.6602 | 0.0078 ** |
| lang           |   0.3373 |     0.1682 |   2.0060 | 0.0449 *  |
| clny           |   0.0192 |     0.1563 |   0.1226 | 0.9024    |
| log_dist_intra |  -0.4884 |     0.1007 |  -4.8506 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9954 

Number of observations: Full 28566; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 13 </code></pre>
</div>
</div>
<p>For the inference, we need to use the Delta method on the estimated coefficients as we did in the OLS case (we need the numbers for the regular expression).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"log_dist_[0-9]{4}"</span>, <span class="fu">rownames</span>(fit_ppml_intra_distance_puzzle<span class="sc">$</span>coef_table), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(beta_log_dist), <span class="fu">max</span>(beta_log_dist))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change = 100 * (beta2 - beta1) / beta1</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> fit_ppml_intra_distance_puzzle<span class="sc">$</span>coef_table[, <span class="dv">1</span>][beta_log_dist]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>beta_pct_chg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> (betas[<span class="dv">2</span>] <span class="sc">-</span> betas[<span class="dv">1</span>]) <span class="sc">/</span> betas[<span class="dv">1</span>])</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>beta_vcov_cluster <span class="ot">&lt;-</span> fit_ppml_intra_distance_puzzle<span class="sc">$</span>vcov[</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ppml_intra_distance_puzzle<span class="sc">$</span>vcov))),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ppml_intra_distance_puzzle<span class="sc">$</span>vcov)))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1) <span class="sc">/</span> x1,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(betas[<span class="dv">1</span>], betas[<span class="dv">2</span>]), beta_vcov_cluster</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_pct_chg <span class="sc">/</span> beta_std_err</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pct_chg_log_dist"</span> <span class="ot">=</span> beta_pct_chg,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pct_chg_log_dist          std_err          p-value 
        -10.9648           1.0580           0.0000 </code></pre>
</div>
</div>
</section>
<section id="internal-distance-and-home-bias-solution-for-the-distance-puzzle" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="internal-distance-and-home-bias-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.5</span> Internal distance and home bias solution for the “distance puzzle”</h3>
<p>This model requires us to add the same country variable to the internal distance model and repeat the rest of the steps from the last section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fit_ppml_home_distance_puzzle <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist_1986 <span class="sc">+</span> log_dist_1990 <span class="sc">+</span> log_dist_1994 <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    log_dist_1998 <span class="sc">+</span> log_dist_2002 <span class="sc">+</span> log_dist_2006 <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    log_dist_intra <span class="sc">+</span> smctry <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application2</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>fit_ppml_home_distance_puzzle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist_1986 + log_dist_1990 + log_dist_1994 + log_dist_1998 + 
    log_dist_2002 + log_dist_2006 + cntg + lang + clny + log_dist_intra + 
    smctry | exp_year + imp_year | pair_id

Family: Poisson

Estimates:

|                | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|----------------|----------|------------|----------|-----------|
| log_dist_1986  |  -0.8570 |     0.0627 | -13.6777 | 0.0000 ** |
| log_dist_1990  |  -0.8189 |     0.0633 | -12.9386 | 0.0000 ** |
| log_dist_1994  |  -0.7958 |     0.0635 | -12.5342 | 0.0000 ** |
| log_dist_1998  |  -0.7699 |     0.0630 | -12.2197 | 0.0000 ** |
| log_dist_2002  |  -0.7666 |     0.0626 | -12.2409 | 0.0000 ** |
| log_dist_2006  |  -0.7544 |     0.0622 | -12.1287 | 0.0000 ** |
| cntg           |   0.5737 |     0.1551 |   3.6995 | 0.0002 ** |
| lang           |   0.3523 |     0.1370 |   2.5719 | 0.0101 *  |
| clny           |   0.0269 |     0.1248 |   0.2155 | 0.8294    |
| log_dist_intra |  -0.6024 |     0.1092 |  -5.5182 | 0.0000 ** |
| smctry         |   1.6890 |     0.5737 |   2.9440 | 0.0032 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9962 

Number of observations: Full 28566; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 12 </code></pre>
</div>
</div>
<p>For the inference, we need to use the Delta method on the estimated coefficients as we did in the OLS case (we need the numbers for the regular expression).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"log_dist_[0-9]{4}"</span>, <span class="fu">rownames</span>(fit_ppml_home_distance_puzzle<span class="sc">$</span>coef_table), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(beta_log_dist), <span class="fu">max</span>(beta_log_dist))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change = 100 * (beta2 - beta1) / beta1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> fit_ppml_home_distance_puzzle<span class="sc">$</span>coef_table[, <span class="dv">1</span>][beta_log_dist]</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>beta_pct_chg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> (betas[<span class="dv">2</span>] <span class="sc">-</span> betas[<span class="dv">1</span>]) <span class="sc">/</span> betas[<span class="dv">1</span>])</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>beta_vcov_cluster <span class="ot">&lt;-</span> fit_ppml_home_distance_puzzle<span class="sc">$</span>vcov[</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ppml_home_distance_puzzle<span class="sc">$</span>vcov))),</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_ppml_home_distance_puzzle<span class="sc">$</span>vcov)))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1) <span class="sc">/</span> x1,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(betas[<span class="dv">1</span>], betas[<span class="dv">2</span>]), beta_vcov_cluster</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_pct_chg <span class="sc">/</span> beta_std_err</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pct_chg_log_dist"</span> <span class="ot">=</span> beta_pct_chg,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pct_chg_log_dist          std_err          p-value 
        -11.9693           1.1730           0.0000 </code></pre>
</div>
</div>
</section>
<section id="fixed-effects-solution-for-the-distance-puzzle" class="level3" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="fixed-effects-solution-for-the-distance-puzzle"><span class="header-section-number">2.2.6</span> Fixed effects solution for the “distance puzzle”</h3>
<p>This model requires us to remove the internal distance and same country variables from the last model and include the internal pair variable to account for the intra-national fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fit_fe_distance_puzzle <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist_1986 <span class="sc">+</span> log_dist_1990 <span class="sc">+</span> log_dist_1994 <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    log_dist_1998 <span class="sc">+</span> log_dist_2002 <span class="sc">+</span> log_dist_2006 <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    intra_pair <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application2</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>fit_fe_distance_puzzle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist_1986 + log_dist_1990 + log_dist_1994 + log_dist_1998 + 
    log_dist_2002 + log_dist_2006 + cntg + lang + clny + intra_pair | 
    exp_year + imp_year | pair_id

Family: Poisson

Estimates:

|                 | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|-----------------|----------|------------|----------|-----------|
| log_dist_1986   |  -0.9100 |     0.0323 | -28.1877 | 0.0000 ** |
| log_dist_1990   |  -0.8790 |     0.0321 | -27.3896 | 0.0000 ** |
| log_dist_1994   |  -0.8598 |     0.0318 | -27.0035 | 0.0000 ** |
| log_dist_1998   |  -0.8329 |     0.0317 | -26.3092 | 0.0000 ** |
| log_dist_2002   |  -0.8292 |     0.0320 | -25.9030 | 0.0000 ** |
| log_dist_2006   |  -0.8105 |     0.0320 | -25.3203 | 0.0000 ** |
| cntg            |   0.4421 |     0.0816 |   5.4149 | 0.0000 ** |
| lang            |   0.2406 |     0.0760 |   3.1649 | 0.0016 ** |
| clny            |  -0.2203 |     0.1165 |  -1.8910 | 0.0586 +  |
| intra_pairAUS   |  -1.0409 |     0.5066 |  -2.0544 | 0.0399 *  |
| intra_pairAUT   |   0.0635 |     0.5297 |   0.1199 | 0.9046    |
| intra_pairBEL   |   0.4164 |     0.5093 |   0.8176 | 0.4136    |
| intra_pairBGR   |   2.4933 |     0.5558 |   4.4861 | 0.0000 ** |
| intra_pairBOL   |   2.6240 |     0.5554 |   4.7243 | 0.0000 ** |
| intra_pairBRA   |  -0.2690 |     0.4173 |  -0.6446 | 0.5192    |
| intra_pairCAN   |  -1.5790 |     0.4864 |  -3.2466 | 0.0012 ** |
| intra_pairCHE   |   0.9178 |     0.5002 |   1.8348 | 0.0665 +  |
| intra_pairCHL   |  -0.1113 |     0.5607 |  -0.1986 | 0.8426    |
| intra_pairCHN   |  -1.4946 |     0.4810 |  -3.1073 | 0.0019 ** |
| intra_pairCMR   |   3.0592 |     0.8006 |   3.8212 | 0.0001 ** |
| intra_pairCOL   |   1.6936 |     0.5048 |   3.3547 | 0.0008 ** |
| intra_pairCRI   |   1.5236 |     0.4901 |   3.1086 | 0.0019 ** |
| intra_pairCYP   |   2.8819 |     0.7195 |   4.0052 | 0.0001 ** |
| intra_pairDEU   |  -1.6567 |     0.4823 |  -3.4351 | 0.0006 ** |
| intra_pairDNK   |   0.1439 |     0.5432 |   0.2649 | 0.7911    |
| intra_pairECU   |   2.1609 |     0.5964 |   3.6232 | 0.0003 ** |
| intra_pairEGY   |   1.9717 |     0.5081 |   3.8806 | 0.0001 ** |
| intra_pairESP   |  -0.7392 |     0.5111 |  -1.4463 | 0.1481    |
| intra_pairFIN   |   0.1308 |     0.5218 |   0.2506 | 0.8021    |
| intra_pairFRA   |  -0.9571 |     0.4795 |  -1.9961 | 0.0459 *  |
| intra_pairGBR   |  -1.4163 |     0.4793 |  -2.9550 | 0.0031 ** |
| intra_pairGRC   |   1.0790 |     0.5476 |   1.9702 | 0.0488 *  |
| intra_pairHKG   |  -2.3710 |     0.5025 |  -4.7189 | 0.0000 ** |
| intra_pairHUN   |   0.5927 |     0.6168 |   0.9610 | 0.3366    |
| intra_pairIDN   |  -0.2140 |     0.5106 |  -0.4190 | 0.6752    |
| intra_pairIND   |   0.5259 |     0.5147 |   1.0218 | 0.3069    |
| intra_pairinter |   1.3019 |     0.5628 |   2.3133 | 0.0207 *  |
| intra_pairIRL   |  -0.6181 |     0.4883 |  -1.2660 | 0.2055    |
| intra_pairIRN   |   2.5378 |     0.6097 |   4.1622 | 0.0000 ** |
| intra_pairISL   |   3.1902 |     0.6502 |   4.9065 | 0.0000 ** |
| intra_pairISR   |   0.2918 |     0.5617 |   0.5196 | 0.6034    |
| intra_pairITA   |  -1.0192 |     0.4938 |  -2.0638 | 0.0390 *  |
| intra_pairJOR   |   3.8689 |     0.6082 |   6.3617 | 0.0000 ** |
| intra_pairJPN   |  -1.7755 |     0.5024 |  -3.5341 | 0.0004 ** |
| intra_pairKEN   |   3.7424 |     0.6182 |   6.0541 | 0.0000 ** |
| intra_pairKOR   |  -0.8640 |     0.5231 |  -1.6519 | 0.0986 +  |
| intra_pairKWT   |   1.6315 |     0.5567 |   2.9307 | 0.0034 ** |
| intra_pairLKA   |   1.7413 |     0.5485 |   3.1745 | 0.0015 ** |
| intra_pairMAC   |   2.8863 |     0.9020 |   3.1998 | 0.0014 ** |
| intra_pairMAR   |   1.7540 |     0.7438 |   2.3583 | 0.0184 *  |
| intra_pairMEX   |  -1.5878 |     0.5143 |  -3.0871 | 0.0020 ** |
| intra_pairMLT   |   1.8356 |     0.5695 |   3.2233 | 0.0013 ** |
| intra_pairMMR   |   5.0208 |     0.5118 |   9.8104 | 0.0000 ** |
| intra_pairMUS   |   1.0756 |     0.7584 |   1.4182 | 0.1561    |
| intra_pairMWI   |   3.6429 |     0.7584 |   4.8037 | 0.0000 ** |
| intra_pairMYS   |  -1.3164 |     0.5493 |  -2.3968 | 0.0165 *  |
| intra_pairNER   |   2.7655 |     1.1507 |   2.4034 | 0.0162 *  |
| intra_pairNGA   |   3.6139 |     0.5060 |   7.1419 | 0.0000 ** |
| intra_pairNLD   |  -0.8928 |     0.5039 |  -1.7720 | 0.0764 +  |
| intra_pairNOR   |   0.5495 |     0.5320 |   1.0329 | 0.3017    |
| intra_pairNPL   |   4.0378 |     0.8442 |   4.7830 | 0.0000 ** |
| intra_pairPAN   |   1.2654 |     0.8971 |   1.4106 | 0.1584    |
| intra_pairPHL   |  -0.5611 |     0.5243 |  -1.0701 | 0.2846    |
| intra_pairPOL   |   1.0607 |     0.5605 |   1.8925 | 0.0584 +  |
| intra_pairPRT   |   0.1395 |     0.5965 |   0.2339 | 0.8151    |
| intra_pairQAT   |   2.0616 |     0.5307 |   3.8847 | 0.0001 ** |
| intra_pairROM   |   1.6095 |     0.5779 |   2.7853 | 0.0053 ** |
| intra_pairSEN   |   3.7758 |     0.9521 |   3.9658 | 0.0001 ** |
| intra_pairSGP   |  -2.5061 |     0.4837 |  -5.1811 | 0.0000 ** |
| intra_pairSWE   |  -0.8703 |     0.5036 |  -1.7281 | 0.0840 +  |
| intra_pairTHA   |  -1.0006 |     0.5214 |  -1.9192 | 0.0550 +  |
| intra_pairTTO   |   2.4571 |     0.5254 |   4.6762 | 0.0000 ** |
| intra_pairTUN   |   2.0248 |     0.7405 |   2.7345 | 0.0062 ** |
| intra_pairTUR   |   0.4969 |     0.5326 |   0.9328 | 0.3509    |
| intra_pairTZA   |   2.2220 |     0.7014 |   3.1678 | 0.0015 ** |
| intra_pairURY   |   1.6219 |     0.7106 |   2.2824 | 0.0225 *  |
| intra_pairUSA   |  -3.4131 |     0.4803 |  -7.1064 | 0.0000 ** |
| intra_pairZAF   |  -0.3844 |     0.5679 |  -0.6768 | 0.4986    |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9993 

Number of observations: Full 28566; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 13 </code></pre>
</div>
</div>
<p>For the inference, we need to use the Delta method on the estimated coefficients as we did in the OLS case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"log_dist_[0-9]{4}"</span>, <span class="fu">rownames</span>(fit_fe_distance_puzzle<span class="sc">$</span>coef_table), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>beta_log_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(beta_log_dist), <span class="fu">max</span>(beta_log_dist))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change = 100 * (beta2 - beta1) / beta1</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> fit_fe_distance_puzzle<span class="sc">$</span>coef_table[, <span class="dv">1</span>][beta_log_dist]</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>beta_pct_chg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> (betas[<span class="dv">2</span>] <span class="sc">-</span> betas[<span class="dv">1</span>]) <span class="sc">/</span> betas[<span class="dv">1</span>])</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>beta_vcov_cluster <span class="ot">&lt;-</span> fit_fe_distance_puzzle<span class="sc">$</span>vcov[</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_fe_distance_puzzle<span class="sc">$</span>vcov))),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(beta_log_dist, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="fu">rownames</span>(fit_fe_distance_puzzle<span class="sc">$</span>vcov)))</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1) <span class="sc">/</span> x1,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(betas[<span class="dv">1</span>], betas[<span class="dv">2</span>]), beta_vcov_cluster</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_pct_chg <span class="sc">/</span> beta_std_err</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pct_chg_log_dist"</span> <span class="ot">=</span> beta_pct_chg,</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pct_chg_log_dist          std_err          p-value 
        -10.9311           0.7688           0.0000 </code></pre>
</div>
</div>
</section>
<section id="presenting-all-models-together-1" class="level3" data-number="2.2.7">
<h3 data-number="2.2.7" class="anchored" data-anchor-id="presenting-all-models-together-1"><span class="header-section-number">2.2.7</span> Presenting all models together</h3>
<p>As it was done in the previous section, we can use the <code>summary_table()</code> function to show all the models fitted in this section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary_table</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  fit_ols_distance_puzzle,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  fit_ppml_distance_puzzle,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  fit_ppml_intra_distance_puzzle,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  fit_ppml_home_distance_puzzle,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  fit_fe_distance_puzzle</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>|      Variable      |        (1)         |        (2)         |        (3)         |        (4)         |        (5)         |
|--------------------|--------------------|--------------------|--------------------|--------------------|--------------------|
| log_dist_1986      |           -1.168** |           -0.859** |           -0.980** |           -0.857** |           -0.910** |
|                    |            (0.043) |            (0.037) |            (0.072) |            (0.063) |            (0.032) |
| log_dist_1990      |           -1.155** |           -0.834** |           -0.940** |           -0.819** |           -0.879** |
|                    |            (0.042) |            (0.038) |            (0.073) |            (0.063) |            (0.032) |
| log_dist_1994      |           -1.211** |           -0.835** |           -0.915** |           -0.796** |           -0.860** |
|                    |            (0.045) |            (0.035) |            (0.072) |            (0.063) |            (0.032) |
| log_dist_1998      |           -1.248** |           -0.847** |           -0.887** |           -0.770** |           -0.833** |
|                    |            (0.042) |            (0.035) |            (0.071) |            (0.063) |            (0.032) |
| log_dist_2002      |           -1.241** |           -0.848** |           -0.884** |           -0.767** |           -0.829** |
|                    |            (0.043) |            (0.032) |            (0.071) |            (0.063) |            (0.032) |
| log_dist_2006      |           -1.261** |           -0.836** |           -0.872** |           -0.754** |           -0.811** |
|                    |            (0.043) |            (0.031) |            (0.071) |            (0.062) |            (0.032) |
| cntg               |              0.223 |            0.437** |            0.371** |            0.574** |            0.442** |
|                    |            (0.199) |            (0.083) |            (0.140) |            (0.155) |            (0.082) |
| lang               |            0.661** |            0.248** |             0.337* |             0.352* |            0.241** |
|                    |            (0.081) |            (0.077) |            (0.168) |            (0.137) |            (0.076) |
| clny               |            0.670** |            -0.222+ |              0.019 |              0.027 |            -0.220+ |
|                    |            (0.147) |            (0.116) |            (0.156) |            (0.125) |            (0.117) |
| log_dist_intra     |                    |                    |           -0.488** |           -0.602** |                    |
|                    |                    |                    |            (0.101) |            (0.109) |                    |
| smctry             |                    |                    |                    |            1.689** |                    |
|                    |                    |                    |                    |            (0.574) |                    |
| intra_pairAUS      |                    |                    |                    |                    |            -1.041* |
|                    |                    |                    |                    |                    |            (0.507) |
| intra_pairAUT      |                    |                    |                    |                    |              0.064 |
|                    |                    |                    |                    |                    |            (0.530) |
| intra_pairBEL      |                    |                    |                    |                    |              0.416 |
|                    |                    |                    |                    |                    |            (0.509) |
| intra_pairBGR      |                    |                    |                    |                    |            2.493** |
|                    |                    |                    |                    |                    |            (0.556) |
| intra_pairBOL      |                    |                    |                    |                    |            2.624** |
|                    |                    |                    |                    |                    |            (0.555) |
| intra_pairBRA      |                    |                    |                    |                    |             -0.269 |
|                    |                    |                    |                    |                    |            (0.417) |
| intra_pairCAN      |                    |                    |                    |                    |           -1.579** |
|                    |                    |                    |                    |                    |            (0.486) |
| intra_pairCHE      |                    |                    |                    |                    |             0.918+ |
|                    |                    |                    |                    |                    |            (0.500) |
| intra_pairCHL      |                    |                    |                    |                    |             -0.111 |
|                    |                    |                    |                    |                    |            (0.561) |
| intra_pairCHN      |                    |                    |                    |                    |           -1.495** |
|                    |                    |                    |                    |                    |            (0.481) |
| intra_pairCMR      |                    |                    |                    |                    |            3.059** |
|                    |                    |                    |                    |                    |            (0.801) |
| intra_pairCOL      |                    |                    |                    |                    |            1.694** |
|                    |                    |                    |                    |                    |            (0.505) |
| intra_pairCRI      |                    |                    |                    |                    |            1.524** |
|                    |                    |                    |                    |                    |            (0.490) |
| intra_pairCYP      |                    |                    |                    |                    |            2.882** |
|                    |                    |                    |                    |                    |            (0.720) |
| intra_pairDEU      |                    |                    |                    |                    |           -1.657** |
|                    |                    |                    |                    |                    |            (0.482) |
| intra_pairDNK      |                    |                    |                    |                    |              0.144 |
|                    |                    |                    |                    |                    |            (0.543) |
| intra_pairECU      |                    |                    |                    |                    |            2.161** |
|                    |                    |                    |                    |                    |            (0.596) |
| intra_pairEGY      |                    |                    |                    |                    |            1.972** |
|                    |                    |                    |                    |                    |            (0.508) |
| intra_pairESP      |                    |                    |                    |                    |             -0.739 |
|                    |                    |                    |                    |                    |            (0.511) |
| intra_pairFIN      |                    |                    |                    |                    |              0.131 |
|                    |                    |                    |                    |                    |            (0.522) |
| intra_pairFRA      |                    |                    |                    |                    |            -0.957* |
|                    |                    |                    |                    |                    |            (0.479) |
| intra_pairGBR      |                    |                    |                    |                    |           -1.416** |
|                    |                    |                    |                    |                    |            (0.479) |
| intra_pairGRC      |                    |                    |                    |                    |             1.079* |
|                    |                    |                    |                    |                    |            (0.548) |
| intra_pairHKG      |                    |                    |                    |                    |           -2.371** |
|                    |                    |                    |                    |                    |            (0.502) |
| intra_pairHUN      |                    |                    |                    |                    |              0.593 |
|                    |                    |                    |                    |                    |            (0.617) |
| intra_pairIDN      |                    |                    |                    |                    |             -0.214 |
|                    |                    |                    |                    |                    |            (0.511) |
| intra_pairIND      |                    |                    |                    |                    |              0.526 |
|                    |                    |                    |                    |                    |            (0.515) |
| intra_pairinter    |                    |                    |                    |                    |             1.302* |
|                    |                    |                    |                    |                    |            (0.563) |
| intra_pairIRL      |                    |                    |                    |                    |             -0.618 |
|                    |                    |                    |                    |                    |            (0.488) |
| intra_pairIRN      |                    |                    |                    |                    |            2.538** |
|                    |                    |                    |                    |                    |            (0.610) |
| intra_pairISL      |                    |                    |                    |                    |            3.190** |
|                    |                    |                    |                    |                    |            (0.650) |
| intra_pairISR      |                    |                    |                    |                    |              0.292 |
|                    |                    |                    |                    |                    |            (0.562) |
| intra_pairITA      |                    |                    |                    |                    |            -1.019* |
|                    |                    |                    |                    |                    |            (0.494) |
| intra_pairJOR      |                    |                    |                    |                    |            3.869** |
|                    |                    |                    |                    |                    |            (0.608) |
| intra_pairJPN      |                    |                    |                    |                    |           -1.775** |
|                    |                    |                    |                    |                    |            (0.502) |
| intra_pairKEN      |                    |                    |                    |                    |            3.742** |
|                    |                    |                    |                    |                    |            (0.618) |
| intra_pairKOR      |                    |                    |                    |                    |            -0.864+ |
|                    |                    |                    |                    |                    |            (0.523) |
| intra_pairKWT      |                    |                    |                    |                    |            1.631** |
|                    |                    |                    |                    |                    |            (0.557) |
| intra_pairLKA      |                    |                    |                    |                    |            1.741** |
|                    |                    |                    |                    |                    |            (0.549) |
| intra_pairMAC      |                    |                    |                    |                    |            2.886** |
|                    |                    |                    |                    |                    |            (0.902) |
| intra_pairMAR      |                    |                    |                    |                    |             1.754* |
|                    |                    |                    |                    |                    |            (0.744) |
| intra_pairMEX      |                    |                    |                    |                    |           -1.588** |
|                    |                    |                    |                    |                    |            (0.514) |
| intra_pairMLT      |                    |                    |                    |                    |            1.836** |
|                    |                    |                    |                    |                    |            (0.569) |
| intra_pairMMR      |                    |                    |                    |                    |            5.021** |
|                    |                    |                    |                    |                    |            (0.512) |
| intra_pairMUS      |                    |                    |                    |                    |              1.076 |
|                    |                    |                    |                    |                    |            (0.758) |
| intra_pairMWI      |                    |                    |                    |                    |            3.643** |
|                    |                    |                    |                    |                    |            (0.758) |
| intra_pairMYS      |                    |                    |                    |                    |            -1.316* |
|                    |                    |                    |                    |                    |            (0.549) |
| intra_pairNER      |                    |                    |                    |                    |             2.765* |
|                    |                    |                    |                    |                    |            (1.151) |
| intra_pairNGA      |                    |                    |                    |                    |            3.614** |
|                    |                    |                    |                    |                    |            (0.506) |
| intra_pairNLD      |                    |                    |                    |                    |            -0.893+ |
|                    |                    |                    |                    |                    |            (0.504) |
| intra_pairNOR      |                    |                    |                    |                    |              0.550 |
|                    |                    |                    |                    |                    |            (0.532) |
| intra_pairNPL      |                    |                    |                    |                    |            4.038** |
|                    |                    |                    |                    |                    |            (0.844) |
| intra_pairPAN      |                    |                    |                    |                    |              1.265 |
|                    |                    |                    |                    |                    |            (0.897) |
| intra_pairPHL      |                    |                    |                    |                    |             -0.561 |
|                    |                    |                    |                    |                    |            (0.524) |
| intra_pairPOL      |                    |                    |                    |                    |             1.061+ |
|                    |                    |                    |                    |                    |            (0.560) |
| intra_pairPRT      |                    |                    |                    |                    |              0.140 |
|                    |                    |                    |                    |                    |            (0.597) |
| intra_pairQAT      |                    |                    |                    |                    |            2.062** |
|                    |                    |                    |                    |                    |            (0.531) |
| intra_pairROM      |                    |                    |                    |                    |            1.610** |
|                    |                    |                    |                    |                    |            (0.578) |
| intra_pairSEN      |                    |                    |                    |                    |            3.776** |
|                    |                    |                    |                    |                    |            (0.952) |
| intra_pairSGP      |                    |                    |                    |                    |           -2.506** |
|                    |                    |                    |                    |                    |            (0.484) |
| intra_pairSWE      |                    |                    |                    |                    |            -0.870+ |
|                    |                    |                    |                    |                    |            (0.504) |
| intra_pairTHA      |                    |                    |                    |                    |            -1.001+ |
|                    |                    |                    |                    |                    |            (0.521) |
| intra_pairTTO      |                    |                    |                    |                    |            2.457** |
|                    |                    |                    |                    |                    |            (0.525) |
| intra_pairTUN      |                    |                    |                    |                    |            2.025** |
|                    |                    |                    |                    |                    |            (0.740) |
| intra_pairTUR      |                    |                    |                    |                    |              0.497 |
|                    |                    |                    |                    |                    |            (0.533) |
| intra_pairTZA      |                    |                    |                    |                    |            2.222** |
|                    |                    |                    |                    |                    |            (0.701) |
| intra_pairURY      |                    |                    |                    |                    |             1.622* |
|                    |                    |                    |                    |                    |            (0.711) |
| intra_pairUSA      |                    |                    |                    |                    |           -3.413** |
|                    |                    |                    |                    |                    |            (0.480) |
| intra_pairZAF      |                    |                    |                    |                    |             -0.384 |
|                    |                    |                    |                    |                    |            (0.568) |
|                    |                    |                    |                    |                    |                    |
| Fixed effects      |                    |                    |                    |                    |                    |
| exp_year           |                Yes |                Yes |                Yes |                Yes |                Yes |
| imp_year           |                Yes |                Yes |                Yes |                Yes |                Yes |
|                    |                    |                    |                    |                    |                    |
| N                  |             25,689 |             28,152 |             28,566 |             28,566 |             28,566 |
| Pseudo R-squared   |              0.843 |              0.946 |              0.995 |              0.996 |              0.999 |

Standard errors in parenthesis
Significance levels: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10</code></pre>
</div>
</div>
</section>
</section>
<section id="regional-trade-agreements-effects" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="regional-trade-agreements-effects"><span class="header-section-number">2.3</span> Regional trade agreements effects</h2>
<section id="preparing-the-data-2" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="preparing-the-data-2"><span class="header-section-number">2.3.1</span> Preparing the data</h3>
<p>This model specification includes gravity covariates, including importer-time and exporter-time fixed effects, as in the equation</p>
<p><span class="math display">\[
\begin{align}
X_{ij,t} =&amp; \:\exp\left[\pi_{i,t} + \chi_{i,t} + \beta_1 \log(DIST)_{i,j} + \beta_2 CNTG_{i,j} + \beta_3 LANG_{i,j} +\right.\\
\text{ }&amp; \:\left.\beta_4 CLNY_{i,j} + \beta_5 RTA_{ij,t}\right] \times \varepsilon_{ij,t}.
\end{align}
\]</span></p>
<p>In comparison to the previous examples, we need to create additional variables to include fixed effects that account for the observations where the exporter and the importer are the same. These variables are internal border, internal dyad and internal borders for different years.</p>
<p>The direct way of obtaining the desired variables is similar to what we did in the previous sections.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>ch1_application3 <span class="ot">&lt;-</span> agtpa_applications <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1986</span>, <span class="dv">2006</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_year =</span> <span class="fu">paste0</span>(exporter, year),</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">imp_year =</span> <span class="fu">paste0</span>(importer, year),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">paste0</span>(<span class="st">"intl_border_"</span>, year),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_trade =</span> <span class="fu">log</span>(trade),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dist =</span> <span class="fu">log</span>(dist),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">intl_brdr =</span> <span class="fu">ifelse</span>(exporter <span class="sc">==</span> importer, pair_id, <span class="st">"inter"</span>),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">intl_brdr_2 =</span> <span class="fu">ifelse</span>(exporter <span class="sc">==</span> importer, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pair_id_2 =</span> <span class="fu">ifelse</span>(exporter <span class="sc">==</span> importer, <span class="st">"0-intra"</span>, pair_id)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> intl_brdr_2, <span class="at">values_fill =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that we used “0-intra” and not just “intra” because the rest of the observations in the internal dyads are numbers 1, …, N, and R internals shall consider “0-intra” as the reference factor for being the first item when it orders the unique observations alphabetically. Also, observe the order of the resulting table, the pivoting of the table will put “0-intra” as the first row for the first exporter-importer dyad. This makes the difference between the expected or other behaviours in the next chapter.</p>
<p>In addition, we need to create the variable containing the trade sum to filter the cases where the sum by dyad is zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ch1_application3 <span class="ot">&lt;-</span> ch1_application3 <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pair_id) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_trade =</span> <span class="fu">sum</span>(trade)) <span class="sc">|&gt;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ols-standard-rta-estimates-with-international-trade-only" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="ols-standard-rta-estimates-with-international-trade-only"><span class="header-section-number">2.3.2</span> OLS standard RTA estimates with international trade only</h3>
<p>The gravity specification, which includes <span class="math inline">\(\pi_{i,t} + \chi_{i,t}\)</span>, means that we need to do something very similar to what we did in the last section.</p>
<p>With the data from above, the model specification is straightforward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fit_ols_rta <span class="ot">&lt;-</span> <span class="fu">felm</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  log_trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> rta <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application3, trade <span class="sc">&gt;</span> <span class="dv">0</span>, importer <span class="sc">!=</span> exporter)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>fit_ols_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: log_trade ~ log_dist + cntg + lang + clny + rta | exp_year + 
    imp_year | pair_id

Estimates:

|          | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|----------|----------|------------|----------|-----------|
| log_dist |  -1.2159 |     0.0384 | -31.6974 | 0.0000 ** |
| cntg     |   0.2230 |     0.1996 |   1.1173 | 0.2638    |
| lang     |   0.6607 |     0.0808 |   8.1785 | 0.0000 ** |
| clny     |   0.6705 |     0.1470 |   4.5614 | 0.0000 ** |
| rta      |  -0.0044 |     0.0531 |  -0.0827 | 0.9341    |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

R-squared     : 0.8432 
Adj. R-squared: 0.838 

Number of observations: Full 25689; Missing 0; Perfect classification 0 </code></pre>
</div>
</div>
</section>
<section id="ppml-standard-rta-estimates-with-international-trade-only" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="ppml-standard-rta-estimates-with-international-trade-only"><span class="header-section-number">2.3.3</span> PPML standard RTA estimates with international trade only</h3>
<p>The model specification is very similar to OLS, and we only need to change the method specified in the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>fit_ppml_rta <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> rta <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">|</span> pair_id,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application3, importer <span class="sc">!=</span> exporter)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>fit_ppml_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist + cntg + lang + clny + rta | exp_year + imp_year | 
    pair_id

Family: Poisson

Estimates:

|          | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|----------|----------|------------|----------|-----------|
| log_dist |  -0.8216 |     0.0310 | -26.5189 | 0.0000 ** |
| cntg     |   0.4155 |     0.0828 |   5.0189 | 0.0000 ** |
| lang     |   0.2499 |     0.0767 |   3.2591 | 0.0011 ** |
| clny     |  -0.2054 |     0.1143 |  -1.7972 | 0.0723 +  |
| rta      |   0.1907 |     0.0658 |   2.8986 | 0.0037 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.946 

Number of observations: Full 28152; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 12 </code></pre>
</div>
</div>
</section>
<section id="addressing-potential-domestic-trade-diversion" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="addressing-potential-domestic-trade-diversion"><span class="header-section-number">2.3.4</span> Addressing potential domestic trade diversion</h3>
<p>The model specification is quite the same as PPML. We only need to add the international border variable but use the entire dataset instead of removing rows where the importer and the exporter are the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fit_intra_rta <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> log_dist <span class="sc">+</span> cntg <span class="sc">+</span> lang <span class="sc">+</span> clny <span class="sc">+</span> rta <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    intl_brdr <span class="sc">|</span> pair_id,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ch1_application3</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>fit_intra_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ log_dist + cntg + lang + clny + rta | exp_year + imp_year + 
    intl_brdr | pair_id

Family: Poisson

Estimates:

|          | Estimate | Std. Error | z value | Pr(&gt;|z|)  |
|----------|----------|------------|---------|-----------|
| log_dist |  -0.5759 |     0.0691 | -8.3311 | 0.0000 ** |
| cntg     |   0.7878 |     0.2852 |  2.7626 | 0.0057 ** |
| lang     |   0.0294 |     0.1984 |  0.1481 | 0.8822    |
| clny     |   0.0432 |     0.2587 |  0.1670 | 0.8674    |
| rta      |   0.5916 |     0.3620 |  1.6344 | 0.1022    |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.988 

Number of observations: Full 28566; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 16 </code></pre>
</div>
</div>
</section>
<section id="addressing-potential-endogeneity-of-rtas" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="addressing-potential-endogeneity-of-rtas"><span class="header-section-number">2.3.5</span> Addressing potential endogeneity of RTAs</h3>
<p>The model specification includes the RTA variable and the exporter-time, importer-time and internal dyad fixed effects to account for domestic trade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>fit_endg_rta <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> rta <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">+</span> pair_id_2 <span class="sc">|</span> pair_id,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application3, sum_trade <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>fit_endg_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ rta | exp_year + imp_year + pair_id_2 | pair_id

Family: Poisson

Estimates:

|     | Estimate | Std. Error | z value | Pr(&gt;|z|)  |
|-----|----------|------------|---------|-----------|
| rta |   0.5572 |     0.1022 |  5.4500 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9988 

Number of observations: Full 28482; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 20 </code></pre>
</div>
</div>
</section>
<section id="testing-for-potential-reverse-causality-between-trade-and-rtas" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="testing-for-potential-reverse-causality-between-trade-and-rtas"><span class="header-section-number">2.3.6</span> Testing for potential “reverse causality” between trade and RTAs</h3>
<p>We need to modify the previous model to include the forward lagged RTA variable (by four years) and consider where the trade sum is larger than zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>fit_lead_rta <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> rta <span class="sc">+</span> rta_lead4 <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">+</span> pair_id_2 <span class="sc">|</span> pair_id,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application3, sum_trade <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>fit_lead_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ rta + rta_lead4 | exp_year + imp_year + pair_id_2 | pair_id

Family: Poisson

Estimates:

|           | Estimate | Std. Error | z value | Pr(&gt;|z|)  |
|-----------|----------|------------|---------|-----------|
| rta       |   0.5200 |     0.0859 |  6.0553 | 0.0000 ** |
| rta_lead4 |   0.0774 |     0.0921 |  0.8405 | 0.4006    |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9988 

Number of observations: Full 28482; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>beta_rta <span class="ot">&lt;-</span> fit_lead_rta<span class="sc">$</span>coef_table[, <span class="dv">1</span>]</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>beta_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(beta_rta)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>beta_form <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste0</span>(<span class="st">"x"</span>, <span class="fu">seq_along</span>(beta_rta)), <span class="at">collapse =</span> <span class="st">"+"</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>beta_form <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"~"</span>, beta_form)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(<span class="fu">as.formula</span>(beta_form), beta_rta, fit_lead_rta<span class="sc">$</span>vcov)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_sum <span class="sc">/</span> beta_std_err</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sum_coef_rta"</span> <span class="ot">=</span> beta_sum,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sum_coef_rta      std_err      p-value 
      0.5975       0.1380       0.0000 </code></pre>
</div>
</div>
</section>
<section id="addressing-potential-non-linear-and-phasing-in-effects-of-rtas" class="level3" data-number="2.3.7">
<h3 data-number="2.3.7" class="anchored" data-anchor-id="addressing-potential-non-linear-and-phasing-in-effects-of-rtas"><span class="header-section-number">2.3.7</span> Addressing potential non-linear and phasing-in effects of RTAs</h3>
<p>Instead of future-lagged RTA variables, as in the previous model, we modify the previous model and include the RTA backwards lagged variables instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fit_phsng_rta <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> rta <span class="sc">+</span> rta_lag4 <span class="sc">+</span> rta_lag8 <span class="sc">+</span> rta_lag12 <span class="sc">|</span> exp_year <span class="sc">+</span> imp_year <span class="sc">+</span> pair_id_2 <span class="sc">|</span> pair_id,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application3, sum_trade <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>fit_phsng_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ rta + rta_lag4 + rta_lag8 + rta_lag12 | exp_year + imp_year + 
    pair_id_2 | pair_id

Family: Poisson

Estimates:

|           | Estimate | Std. Error | z value | Pr(&gt;|z|)  |
|-----------|----------|------------|---------|-----------|
| rta       |   0.2914 |     0.0892 |  3.2680 | 0.0011 ** |
| rta_lag4  |   0.4135 |     0.0672 |  6.1498 | 0.0000 ** |
| rta_lag8  |   0.1687 |     0.0431 |  3.9117 | 0.0001 ** |
| rta_lag12 |   0.1189 |     0.0301 |  3.9552 | 0.0001 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.999 

Number of observations: Full 28482; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>beta_rta <span class="ot">&lt;-</span> fit_phsng_rta<span class="sc">$</span>coef_table[, <span class="dv">1</span>]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>beta_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(beta_rta)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>beta_form <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste0</span>(<span class="st">"x"</span>, <span class="fu">seq_along</span>(beta_rta)), <span class="at">collapse =</span> <span class="st">"+"</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>beta_form <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"~"</span>, beta_form)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(<span class="fu">as.formula</span>(beta_form), beta_rta, fit_phsng_rta<span class="sc">$</span>vcov)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_sum <span class="sc">/</span> beta_std_err</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sum_coef_rta"</span> <span class="ot">=</span> beta_sum,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sum_coef_rta      std_err      p-value 
      0.9926       0.0943       0.0000 </code></pre>
</div>
</div>
</section>
<section id="addressing-globalization-effects" class="level3" data-number="2.3.8">
<h3 data-number="2.3.8" class="anchored" data-anchor-id="addressing-globalization-effects"><span class="header-section-number">2.3.8</span> Addressing globalization effects</h3>
<p>In addition to the previous model, we include the international borders on different years besides the lagged RTAs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fit_glbzn_rta <span class="ot">&lt;-</span> <span class="fu">fepoisson</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  trade <span class="sc">~</span> rta <span class="sc">+</span> rta_lag4 <span class="sc">+</span> rta_lag8 <span class="sc">+</span> rta_lag12 <span class="sc">+</span> intl_border_1986 <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    intl_border_1990 <span class="sc">+</span> intl_border_1994 <span class="sc">+</span> intl_border_1998 <span class="sc">+</span> intl_border_2002 <span class="sc">|</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    exp_year <span class="sc">+</span> imp_year <span class="sc">+</span> pair_id_2 <span class="sc">|</span> pair_id,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(ch1_application3, sum_trade <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>fit_glbzn_rta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: trade ~ rta + rta_lag4 + rta_lag8 + rta_lag12 + intl_border_1986 + 
    intl_border_1990 + intl_border_1994 + intl_border_1998 + 
    intl_border_2002 | exp_year + imp_year + pair_id_2 | pair_id

Family: Poisson

Estimates:

|                  | Estimate | Std. Error | z value  | Pr(&gt;|z|)  |
|------------------|----------|------------|----------|-----------|
| rta              |   0.1157 |     0.0867 |   1.3342 | 0.1822    |
| rta_lag4         |   0.2877 |     0.0617 |   4.6666 | 0.0000 ** |
| rta_lag8         |   0.0693 |     0.0482 |   1.4382 | 0.1504    |
| rta_lag12        |   0.0024 |     0.0291 |   0.0809 | 0.9355    |
| intl_border_1986 |  -0.7056 |     0.0478 | -14.7642 | 0.0000 ** |
| intl_border_1990 |  -0.4803 |     0.0429 | -11.1830 | 0.0000 ** |
| intl_border_1994 |  -0.3665 |     0.0335 | -10.9550 | 0.0000 ** |
| intl_border_1998 |  -0.1581 |     0.0233 |  -6.7950 | 0.0000 ** |
| intl_border_2002 |  -0.1409 |     0.0169 |  -8.3453 | 0.0000 ** |

Significance codes: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10

Pseudo R-squared: 0.9996 

Number of observations: Full 28482; Missing 0; Perfect classification 0 

Number of Fisher Scoring iterations: 20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>beta_rta <span class="ot">&lt;-</span> fit_glbzn_rta<span class="sc">$</span>coef_table[, <span class="dv">1</span>][<span class="fu">grep</span>(<span class="st">"rta"</span>, <span class="fu">rownames</span>(fit_glbzn_rta<span class="sc">$</span>coef_table))]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>beta_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(beta_rta)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>beta_form <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste0</span>(<span class="st">"x"</span>, <span class="fu">seq_along</span>(beta_rta)), <span class="at">collapse =</span> <span class="st">"+"</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>beta_form <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"~"</span>, beta_form)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>beta_std_err <span class="ot">&lt;-</span> <span class="fu">deltamethod</span>(<span class="fu">as.formula</span>(beta_form), beta_rta, fit_glbzn_rta<span class="sc">$</span>vcov[<span class="fu">names</span>(beta_rta), <span class="fu">names</span>(beta_rta)])</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>beta_tstat <span class="ot">&lt;-</span> beta_sum <span class="sc">/</span> beta_std_err</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>beta_pval <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(beta_tstat)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(beta_tstat)))</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sum_coef_rta"</span> <span class="ot">=</span> beta_sum,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"std_err"</span> <span class="ot">=</span> beta_std_err,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> beta_pval</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sum_coef_rta      std_err      p-value 
      0.4750       0.1095       0.0000 </code></pre>
</div>
</div>
</section>
<section id="presenting-all-models-together-2" class="level3" data-number="2.3.9">
<h3 data-number="2.3.9" class="anchored" data-anchor-id="presenting-all-models-together-2"><span class="header-section-number">2.3.9</span> Presenting all models together</h3>
<p>As it was done in the previous sections, we can use the <code>summary_table()</code> function to show all the models fitted in this section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary_table</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  fit_ols_rta,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  fit_ppml_rta,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  fit_intra_rta,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  fit_endg_rta,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  fit_lead_rta,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  fit_phsng_rta,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  fit_glbzn_rta</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>|      Variable      |        (1)         |        (2)         |        (3)         |        (4)        |        (5)        |        (6)        |        (7)         |
|--------------------|--------------------|--------------------|--------------------|-------------------|-------------------|-------------------|--------------------|
| log_dist           |           -1.216** |           -0.822** |           -0.576** |                   |                   |                   |                    |
|                    |            (0.038) |            (0.031) |            (0.069) |                   |                   |                   |                    |
| cntg               |              0.223 |            0.416** |            0.788** |                   |                   |                   |                    |
|                    |            (0.200) |            (0.083) |            (0.285) |                   |                   |                   |                    |
| lang               |            0.661** |            0.250** |              0.029 |                   |                   |                   |                    |
|                    |            (0.081) |            (0.077) |            (0.198) |                   |                   |                   |                    |
| clny               |            0.670** |            -0.205+ |              0.043 |                   |                   |                   |                    |
|                    |            (0.147) |            (0.114) |            (0.259) |                   |                   |                   |                    |
| rta                |             -0.004 |            0.191** |              0.592 |           0.557** |           0.520** |           0.291** |              0.116 |
|                    |            (0.053) |            (0.066) |            (0.362) |           (0.102) |           (0.086) |           (0.089) |            (0.087) |
| rta_lead4          |                    |                    |                    |                   |             0.077 |                   |                    |
|                    |                    |                    |                    |                   |           (0.092) |                   |                    |
| rta_lag4           |                    |                    |                    |                   |                   |           0.414** |            0.288** |
|                    |                    |                    |                    |                   |                   |           (0.067) |            (0.062) |
| rta_lag8           |                    |                    |                    |                   |                   |           0.169** |              0.069 |
|                    |                    |                    |                    |                   |                   |           (0.043) |            (0.048) |
| rta_lag12          |                    |                    |                    |                   |                   |           0.119** |              0.002 |
|                    |                    |                    |                    |                   |                   |           (0.030) |            (0.029) |
| intl_border_1986   |                    |                    |                    |                   |                   |                   |           -0.706** |
|                    |                    |                    |                    |                   |                   |                   |            (0.048) |
| intl_border_1990   |                    |                    |                    |                   |                   |                   |           -0.480** |
|                    |                    |                    |                    |                   |                   |                   |            (0.043) |
| intl_border_1994   |                    |                    |                    |                   |                   |                   |           -0.367** |
|                    |                    |                    |                    |                   |                   |                   |            (0.033) |
| intl_border_1998   |                    |                    |                    |                   |                   |                   |           -0.158** |
|                    |                    |                    |                    |                   |                   |                   |            (0.023) |
| intl_border_2002   |                    |                    |                    |                   |                   |                   |           -0.141** |
|                    |                    |                    |                    |                   |                   |                   |            (0.017) |
|                    |                    |                    |                    |                   |                   |                   |                    |
| Fixed effects      |                    |                    |                    |                   |                   |                   |                    |
| exp_year           |                Yes |                Yes |                Yes |               Yes |               Yes |               Yes |                Yes |
| imp_year           |                Yes |                Yes |                Yes |               Yes |               Yes |               Yes |                Yes |
| intl_brdr          |                 No |                 No |                Yes |                No |                No |                No |                 No |
| pair_id_2          |                 No |                 No |                 No |               Yes |               Yes |               Yes |                Yes |
|                    |                    |                    |                    |                   |                   |                   |                    |
| N                  |             25,689 |             28,152 |             28,566 |            28,482 |            28,482 |            28,482 |             28,482 |
| Pseudo R-squared   |              0.843 |              0.946 |              0.988 |             0.999 |             0.999 |             0.999 |              1.000 |

Standard errors in parenthesis
Significance levels: ** p &lt; 0.01; * p &lt; 0.05; + p &lt; 0.10</code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="references"><span class="header-section-number">2.4</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-wickham2016r" class="csl-entry" role="listitem">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. " O’Reilly Media, Inc.".
</div>
<div id="ref-yotov2016advanced" class="csl-entry" role="listitem">
Yotov, Yoto V, Roberta Piermartini, José-Antonio Monteiro, and Mario Larch. 2016. <em>An Advanced Guide to Trade Policy Analysis: The Structural Gravity Model</em>. World Trade Organization Geneva.
</div>
<div id="ref-trimmingfat" class="csl-entry" role="listitem">
Zumel, Nina. 2014. <span>“Trimming the Fat from Glm() Models in r.”</span> <a href="https://win-vector.com/2014/05/30/trimming-the-fat-from-glm-models-in-r/" class="uri">https://win-vector.com/2014/05/30/trimming-the-fat-from-glm-models-in-r/</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-general-equilibrium.html" class="pagination-link" aria-label="General equilibrium trade policy analysis with structural gravity">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">General equilibrium trade policy analysis with structural gravity</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>